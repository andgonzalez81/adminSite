<?php
// Include your file which makes a connection to your database
//include('include/class.database.php');        
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Drag, drop and sort images with Javascript's Prototype</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="pragma" content="no-cache" />
    
    <script type="text/javascript" src="scriptaculous/lib/prototype.js"></script>
    <script type="text/javascript" src="scriptaculous/src/scriptaculous.js"></script>
    <script type="text/javascript"> 
        //<![CDATA[
	document.observe('dom:loaded', function() {
        var changeEffect;
        Sortable.create("sortlist2", {containment: ['sortlist', 'sortlist2'], tag:'img', overlap:'horizontal', constraint:false, dropOnEmpty: true,
			onChange: function(item) {
				var list = Sortable.options(item).element;
				$('changeNotification').update(Sortable.serialize(list).escapeHTML());
				if(changeEffect) changeEffect.cancel();
				changeEffect = new Effect.Highlight('changeNotification', {restoreColor:"transparent" });
			},			
			onUpdate: function(list) {
				new Ajax.Request("saveImageOrderSortable.php", {
					method: "post",
					onLoading: function(){$('activityIndicator').show()},
					onLoaded: function(){$('activityIndicator').hide()},
					parameters: { data: Sortable.serialize(list), container: list.id }
				});				
			}
		});			
		
		Sortable.create("sortlist", {containment: ['sortlist', 'sortlist2'], tag:'img', overlap:'horizontal', constraint:false, dropOnEmpty: true,
			onChange: function(item) {
				var list = Sortable.options(item).element;
				$('changeNotification').update(Sortable.serialize(list).escapeHTML());
				if(changeEffect) changeEffect.cancel();
				changeEffect = new Effect.Highlight('changeNotification', {restoreColor:"transparent" });
			},			
			onUpdate: function(list) {
				new Ajax.Request("saveImageOrder.php", {
					method: "post",
					onLoading: function(){$('activityIndicator').show()},
					onLoaded: function(){$('activityIndicator').hide()},
					parameters: { data: Sortable.serialize(list), container: list.id }
				});
			}
		});	
	});
	//]]>
	</script> 
    	
    <style>
    <!--
    #sortlist {
        width: 360px;
        margin: 0 auto;
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid #a5a1a1;
        text-align:center;

        }
    #sortlist img.sorting {
        float: left;
        margin: 4px;
        padding: 4px;
        border: 1px solid #ccc;
        }
        
    #sortlist img.sorting:hover { 
        float: left;
        margin: 4px;
        padding: 4px;
        border: 1px solid #666; 
        cursor: move;
        }
    -->
    </style>
</head>

	<body> 
		<h1>Demo: Drag and drop between lists 2 divs with Prototype &amp; Script.aculo.us</h1> 
		<div id="tagLine">a fresh how-to guide with the help of the powerful Javascript framework named Prototype and its glamourous sidekick Script.aculo.us</div> 
 
			<div id="credits">Author: <a onClick="javascript:urchinTracker('/mailto/nikolaas');" href="mailto:nikolaas [[AT]] torn [[DOT]] be" title="The author of this article is Nikolaas De Geyndt">Nikolaas De Geyndt</a> 
				 | This demo appeared on tutorial: <a href="http://webdesign.torn.be/tutorials/javascript/prototype/sort-images-with-prototype/" title="This article appeared on http://webdesign.torn.be/tutorials/javascript/prototype/sort-images-with-prototype/">http://webdesign.torn.be/tutorials/javascript/prototype/sort-images-with-prototype/</a></div> 

<br /> 
    	<p id="changeNotification"></p> 
        <div id="activityIndicator" style="display:none; ">Saving image order to database <img src="../../../../assets/images/loading_indicator.gif" /></div> 

	<div id="wrapper">
		<div id="sortlist"> 
			<img class="sorting" alt="West Hollywood home" id="pictureId_7" src="images/tn_7.jpg" /><img class="sorting" alt="Highway 1 Chipmunk" id="pictureId_8" src="images/tn_8.jpg" /><img class="sorting" alt="San Francisco fire trucks" id="pictureId_9" src="images/tn_9.jpg" /><img class="sorting" alt="Grand Canyon Rainbow" id="pictureId_3" src="images/tn_3.jpg" />        </div> 
        
		<div id="sortlist2"> 
			<img class="sorting" alt="MGM Las Vegas" id="pictureId_1" src="images/tn_1.jpg" /><img class="sorting" alt="Desert road" id="pictureId_6" src="images/tn_6.jpg" /><img class="sorting" alt="Yosemite" id="pictureId_4" src="images/tn_4.jpg" /><img class="sorting" alt="California Wine County" id="pictureId_5" src="images/tn_5.jpg" /><img class="sorting" alt="Hurricane Truck" id="pictureId_2" src="images/tn_2.jpg" />        
        </div>       


   	    <hr style="clear:both;visibility:hidden;" />            
    
        <p style="text-align:center; font: normal 1em Georgia, 'Times New Roman', Times, serif">Attention: if you see flickering when dragging and dropping, do the following: 
        <ul>
        	<li>Open dragdrop.js which came as a .js file with the scriptaculous package v1.8.1</li>

            <li>Replace this <pre>if(!Element.isParent(dropon, element)) {</pre></li>
            <li>with <pre>if((!Element.isParent(dropon, element)) && (Element.empty(dropon))) {</pre></li>
		</ul>            
        <p>If you're in the hacking modus and want to add dropzone markers: feel free to follow <a href="http://ajithmanmadhan.wordpress.com/2009/05/30/drag-and-drop-with-drop-zone-markers/" target="_blank">this guide</a></p>
            
	</div>        

</body>
</html>
		
